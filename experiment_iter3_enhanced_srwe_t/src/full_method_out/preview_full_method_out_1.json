{
  "metadata": {
    "method_name": "Enhanced SRWE: Tikhonov/TSVD/MPM Spectral Recovery + GNN Benchmark",
    "description": "Implements three SRWE spectral recovery methods and benchmarks SRWE as a GNN PE against RWSE and LapPE",
    "hyperparameters": {
      "best_tik_alpha": 1e-06,
      "best_tik_w1": 0.12331364451319746,
      "best_tsvd_thresh": 0.01,
      "best_tsvd_w1": 0.15575631172752322
    },
    "gnn_benchmark": {
      "Peptides-func": {
        "metric": "AP",
        "task_type": "classification",
        "results": {
          "none": {
            "mean": 0.42457619163146215,
            "std": 0.011705752498533624,
            "per_seed": [
              0.4299960259927924,
              0.4354127134277828,
              0.4083198354738114
            ],
            "n_seeds": 3
          },
          "rwse": {
            "mean": 0.4550992067774115,
            "std": 0.00564935355690595,
            "per_seed": [
              0.4476734393038244,
              0.4562593906713814,
              0.46136479035702854
            ],
            "n_seeds": 3
          },
          "lappe": {
            "mean": 0.3699164917030786,
            "std": 0.005636934923039237,
            "per_seed": [
              0.37779633486596575,
              0.36493081356005186,
              0.3670223266832181
            ],
            "n_seeds": 3
          },
          "srwe": {
            "mean": 0.419782178986925,
            "std": 0.008655002758437572,
            "per_seed": [
              0.4217522692185722,
              0.4292590967596907,
              0.40833517098251215
            ],
            "n_seeds": 3
          }
        }
      },
      "Peptides-struct": {
        "metric": "MAE",
        "task_type": "regression",
        "results": {
          "none": {
            "mean": 44.625989278157554,
            "std": 0.2831427101448155,
            "per_seed": [
              44.29023742675781,
              44.98283004760742,
              44.60490036010742
            ],
            "n_seeds": 3
          },
          "rwse": {
            "mean": 35.04758961995443,
            "std": 0.7403399563471709,
            "per_seed": [
              36.08409881591797,
              34.40130615234375,
              34.65736389160156
            ],
            "n_seeds": 3
          },
          "lappe": {
            "mean": 22.82112693786621,
            "std": 1.126479575387091,
            "per_seed": [
              24.413707733154297,
              21.99020767211914,
              22.059465408325195
            ],
            "n_seeds": 3
          },
          "srwe": {
            "mean": 30.383663813273113,
            "std": 0.15040137285523067,
            "per_seed": [
              30.17564582824707,
              30.449237823486328,
              30.526107788085938
            ],
            "n_seeds": 3
          }
        }
      },
      "ZINC-subset": {
        "metric": "MAE",
        "task_type": "regression",
        "results": {
          "none": {
            "mean": 0.48890677094459534,
            "std": 0.003426295873740818,
            "per_seed": [
              0.4874211549758911,
              0.4856553375720978,
              0.4936438202857971
            ],
            "n_seeds": 3
          },
          "rwse": {
            "mean": 0.3798287510871887,
            "std": 0.01437670730001708,
            "per_seed": [
              0.3954535126686096,
              0.36074984073638916,
              0.3832828998565674
            ],
            "n_seeds": 3
          },
          "lappe": {
            "mean": 0.5249936381975809,
            "std": 0.0036419669838876874,
            "per_seed": [
              0.5218294262886047,
              0.5300952196121216,
              0.5230562686920166
            ],
            "n_seeds": 3
          },
          "srwe": {
            "mean": 0.4366539418697357,
            "std": 0.009231383981383089,
            "per_seed": [
              0.431806355714798,
              0.4495755136013031,
              0.4285799562931061
            ],
            "n_seeds": 3
          }
        }
      },
      "analysis": {
        "best_srwe_method": "tikhonov",
        "gap_closed": {
          "Peptides-func": 41.46,
          "Peptides-struct": 38.15,
          "ZINC-subset": 39.15
        }
      }
    },
    "spectral_recovery": {
      "ZINC-subset": {
        "methods": {
          "tikhonov": {
            "mean_w1": 0.09012353703871728,
            "std_w1": 0.03718898628765515,
            "mean_cosine": 0.7412585328880676,
            "std_cosine": 0.058889530362659294,
            "mean_top5_acc": 0.6016971201771086,
            "std_top5_acc": 0.0878298622385472
          },
          "tsvd": {
            "mean_w1": 0.12167707097382677,
            "std_w1": 0.03599638518318104,
            "mean_cosine": 0.6376927659144098,
            "std_cosine": 0.050680073882551496,
            "mean_top5_acc": 0.46800058833691555,
            "std_top5_acc": 0.07485916427440409
          },
          "mpm": {
            "mean_w1": 0.12193906918838551,
            "std_w1": 0.02772693504149629,
            "mean_cosine": 0.4304823500355219,
            "std_cosine": 0.09727169973846866,
            "mean_top5_acc": 0.37266520830283634,
            "std_top5_acc": 0.08539990532417484
          }
        },
        "sri_stratified": {
          "tikhonov": {
            "very_low": {
              "mean_w1": 0.08265713175449461,
              "std_w1": 0.029927588030831797,
              "count": 2133
            },
            "low": {
              "mean_w1": 0.08673963960475524,
              "std_w1": 0.03255822835492498,
              "count": 3745
            },
            "medium": {
              "mean_w1": 0.09078889451567879,
              "std_w1": 0.036302754642560206,
              "count": 4377
            },
            "high": {
              "mean_w1": 0.10484346178643887,
              "std_w1": 0.050247110175340975,
              "count": 1745
            }
          },
          "tsvd": {
            "very_low": {
              "mean_w1": 0.11544403596224292,
              "std_w1": 0.029004631071185963,
              "count": 2133
            },
            "low": {
              "mean_w1": 0.11845956298342782,
              "std_w1": 0.03117347526296055,
              "count": 3745
            },
            "medium": {
              "mean_w1": 0.12182086531605331,
              "std_w1": 0.03516858884318718,
              "count": 4377
            },
            "high": {
              "mean_w1": 0.13584053416455844,
              "std_w1": 0.049233253384365815,
              "count": 1745
            }
          },
          "mpm": {
            "very_low": {
              "mean_w1": 0.1122560714331432,
              "std_w1": 0.0184272801329064,
              "count": 2133
            },
            "low": {
              "mean_w1": 0.11773001958639975,
              "std_w1": 0.02344977838809918,
              "count": 3745
            },
            "medium": {
              "mean_w1": 0.12407102684088987,
              "std_w1": 0.027457477069309087,
              "count": 4377
            },
            "high": {
              "mean_w1": 0.13746064301437813,
              "std_w1": 0.037357131269187244,
              "count": 1745
            }
          }
        }
      },
      "Peptides-func": {
        "methods": {
          "tikhonov": {
            "mean_w1": 0.1211730770620888,
            "std_w1": 0.04934483503488319,
            "mean_cosine": 0.39429731661427003,
            "std_cosine": 0.1722044183398649,
            "mean_top5_acc": 0.2030569630282909,
            "std_top5_acc": 0.1540305534762556
          },
          "tsvd": {
            "mean_w1": 0.1540881089562194,
            "std_w1": 0.04156805731699088,
            "mean_cosine": 0.34982751735974954,
            "std_cosine": 0.13076167175820755,
            "mean_top5_acc": 0.13013520765788925,
            "std_top5_acc": 0.11677763527731776
          },
          "mpm": {
            "mean_w1": 0.23661480109772096,
            "std_w1": 0.16454981333135063,
            "mean_cosine": 0.10725607123950297,
            "std_cosine": 0.09836053763944874,
            "mean_top5_acc": 0.08299063199519785,
            "std_top5_acc": 0.08772283336586864
          }
        },
        "sri_stratified": {
          "tikhonov": {
            "very_low": {
              "mean_w1": 0.12268617919863976,
              "std_w1": 0.049949554009639005,
              "count": 1865
            },
            "low": {
              "mean_w1": 0.09867732495370371,
              "std_w1": 0.028173023007473156,
              "count": 74
            },
            "medium": {
              "mean_w1": 0.09116361685557212,
              "std_w1": 0.02987782512063217,
              "count": 36
            },
            "high": {
              "mean_w1": 0.11809670661359081,
              "std_w1": 0.04537919654658017,
              "count": 25
            }
          },
          "tsvd": {
            "very_low": {
              "mean_w1": 0.15569291710953242,
              "std_w1": 0.041787343130944614,
              "count": 1865
            },
            "low": {
              "mean_w1": 0.13164450461175928,
              "std_w1": 0.02594996327532019,
              "count": 74
            },
            "medium": {
              "mean_w1": 0.1222171713151335,
              "std_w1": 0.028515819964541906,
              "count": 36
            },
            "high": {
              "mean_w1": 0.14669663978183517,
              "std_w1": 0.040030481191174985,
              "count": 25
            }
          },
          "mpm": {
            "very_low": {
              "mean_w1": 0.24365661861855514,
              "std_w1": 0.16813865791672858,
              "count": 1865
            },
            "low": {
              "mean_w1": 0.13837068204672426,
              "std_w1": 0.018212165790407676,
              "count": 74
            },
            "medium": {
              "mean_w1": 0.1357125403037308,
              "std_w1": 0.02284799578884157,
              "count": 36
            },
            "high": {
              "mean_w1": 0.14739706197778768,
              "std_w1": 0.02281936855817021,
              "count": 25
            }
          }
        }
      },
      "Peptides-struct": {
        "methods": {
          "tikhonov": {
            "mean_w1": 0.1211730770620888,
            "std_w1": 0.04934483503488319,
            "mean_cosine": 0.39429731661427003,
            "std_cosine": 0.1722044183398649,
            "mean_top5_acc": 0.2030569630282909,
            "std_top5_acc": 0.1540305534762556
          },
          "tsvd": {
            "mean_w1": 0.1540881089562194,
            "std_w1": 0.04156805731699088,
            "mean_cosine": 0.34982751735974954,
            "std_cosine": 0.13076167175820755,
            "mean_top5_acc": 0.13013520765788925,
            "std_top5_acc": 0.11677763527731776
          },
          "mpm": {
            "mean_w1": 0.23661480109772096,
            "std_w1": 0.16454981333135063,
            "mean_cosine": 0.10725607123950297,
            "std_cosine": 0.09836053763944874,
            "mean_top5_acc": 0.08299063199519785,
            "std_top5_acc": 0.08772283336586864
          }
        },
        "sri_stratified": {
          "tikhonov": {
            "very_low": {
              "mean_w1": 0.12268617919863976,
              "std_w1": 0.049949554009639005,
              "count": 1865
            },
            "low": {
              "mean_w1": 0.09867732495370371,
              "std_w1": 0.028173023007473156,
              "count": 74
            },
            "medium": {
              "mean_w1": 0.09116361685557212,
              "std_w1": 0.02987782512063217,
              "count": 36
            },
            "high": {
              "mean_w1": 0.11809670661359081,
              "std_w1": 0.04537919654658017,
              "count": 25
            }
          },
          "tsvd": {
            "very_low": {
              "mean_w1": 0.15569291710953242,
              "std_w1": 0.041787343130944614,
              "count": 1865
            },
            "low": {
              "mean_w1": 0.13164450461175928,
              "std_w1": 0.02594996327532019,
              "count": 74
            },
            "medium": {
              "mean_w1": 0.1222171713151335,
              "std_w1": 0.028515819964541906,
              "count": 36
            },
            "high": {
              "mean_w1": 0.14669663978183517,
              "std_w1": 0.040030481191174985,
              "count": 25
            }
          },
          "mpm": {
            "very_low": {
              "mean_w1": 0.24365661861855514,
              "std_w1": 0.16813865791672858,
              "count": 1865
            },
            "low": {
              "mean_w1": 0.13837068204672426,
              "std_w1": 0.018212165790407676,
              "count": 74
            },
            "medium": {
              "mean_w1": 0.1357125403037308,
              "std_w1": 0.02284799578884157,
              "count": 36
            },
            "high": {
              "mean_w1": 0.14739706197778768,
              "std_w1": 0.02281936855817021,
              "count": 25
            }
          }
        }
      },
      "Synthetic-aliased-pairs": {
        "methods": {
          "tikhonov": {
            "mean_w1": 0.19512595277000414,
            "std_w1": 0.27026409500382387,
            "mean_cosine": 0.7019324265740314,
            "std_cosine": 0.22206542312239783,
            "mean_top5_acc": 0.6462791847041848,
            "std_top5_acc": 0.19481836524244112
          },
          "tsvd": {
            "mean_w1": 0.2280902973230753,
            "std_w1": 0.2614847587716808,
            "mean_cosine": 0.655805094441972,
            "std_cosine": 0.19556107305660145,
            "mean_top5_acc": 0.6039875279691068,
            "std_top5_acc": 0.17624725262915286
          },
          "mpm": {
            "mean_w1": 0.224476606219333,
            "std_w1": 0.24616910743522152,
            "mean_cosine": 0.46021265626933217,
            "std_cosine": 0.17860573025605583,
            "mean_top5_acc": 0.5672139988666305,
            "std_top5_acc": 0.19309393271417832
          }
        },
        "sri_stratified": {
          "tikhonov": {
            "very_low": {
              "mean_w1": 0.026857051030636233,
              "std_w1": 0.0,
              "count": 1
            },
            "low": {
              "mean_w1": 0.0009016286609826076,
              "std_w1": 0.0,
              "count": 1
            },
            "medium": {
              "mean_w1": 0.04583575567926728,
              "std_w1": 0.024980793601214434,
              "count": 8
            },
            "high": {
              "mean_w1": 0.2124238950208295,
              "std_w1": 0.27944405277730666,
              "count": 90
            }
          },
          "tsvd": {
            "very_low": {
              "mean_w1": 0.07507821204012402,
              "std_w1": 0.0,
              "count": 1
            },
            "low": {
              "mean_w1": 0.07017116806202653,
              "std_w1": 0.0,
              "count": 1
            },
            "medium": {
              "mean_w1": 0.09109581922496557,
              "std_w1": 0.022132873958539613,
              "count": 8
            },
            "high": {
              "mean_w1": 0.24372237553784062,
              "std_w1": 0.27106836735014894,
              "count": 90
            }
          },
          "mpm": {
            "very_low": {
              "mean_w1": 0.1000249286105229,
              "std_w1": 0.0,
              "count": 1
            },
            "low": {
              "mean_w1": 0.1614671181023797,
              "std_w1": 0.0,
              "count": 1
            },
            "medium": {
              "mean_w1": 0.14887151870012366,
              "std_w1": 0.023118290089619725,
              "count": 8
            },
            "high": {
              "mean_w1": 0.23327996028466014,
              "std_w1": 0.25784329735707817,
              "count": 90
            }
          }
        }
      }
    },
    "consistency_check": {
      "mean_relative_error": 4.823479062780468e-07,
      "max_relative_error": 2.5999324075373273e-05,
      "n_checks": 250
    },
    "gnn_config": {
      "hidden_dim": 64,
      "num_layers": 3,
      "dropout": 0.1,
      "lr": 0.001,
      "weight_decay": 1e-05,
      "batch_size": 64,
      "max_epochs": 200,
      "patience": 50,
      "seeds": [
        0,
        1,
        2
      ]
    }
  },
  "datasets": [
    {
      "dataset": "ZINC-subset",
      "examples": [
        {
          "input": "{\"edge_index\":[[0,1,1,2,2,3,3,4,4,5,5,6,6,6,7,7,8,8,8,9,9,9,10,11,11,11,12,12,13,13,13,14,14,14,15,16,16,16,17,17,17,18,18,19,19,20,20,20,21,22,22,23,23,23,24,25,25,25,26,27,27,28,28,28,29,30,30,31,31...",
          "output": "3.046437978744507",
          "predict_none": "[2.181254]",
          "predict_rwse": "[2.224726]",
          "predict_lappe": "[2.820042]",
          "predict_srwe": "[2.221471]",
          "metadata_srwe_best_method": "tikhonov",
          "metadata_srwe_best_w1": "0.049927",
          "metadata_srwe_best_cosine": "0.725026",
          "metadata_sri_k20": 0.36452,
          "metadata_dataset": "ZINC-subset"
        },
        {
          "input": "{\"edge_index\":[[0,1,1,2,2,3,3,4,4,4,5,6,6,6,7,8,8,8,9,10,10,11,11,11,12,12,13,13,14,14,14,15,16,16,17,17],[1,0,2,1,3,2,4,3,5,6,4,4,7,8,6,6,9,10,8,8,11,10,12,17,11,13,12,14,13,15,16,14,14,17,11,16]],\"n...",
          "output": "0.49065685272216797",
          "predict_none": "[-0.150374]",
          "predict_rwse": "[0.480673]",
          "predict_lappe": "[0.145534]",
          "predict_srwe": "[-0.008386]",
          "metadata_srwe_best_method": "tikhonov",
          "metadata_srwe_best_w1": "0.051976",
          "metadata_srwe_best_cosine": "0.816565",
          "metadata_sri_k20": 3.32722,
          "metadata_dataset": "ZINC-subset"
        },
        {
          "input": "{\"edge_index\":[[0,1,1,2,2,3,3,3,4,4,4,5,5,6,6,6,7,8,8,8,9,9,10,10,10,11,11,11,12,12,12,13,14,14,15,15,15,16,17,17,17,18,19,19,20,20,21,21,22,22,22,23,23,23,24,24,25,25],[1,0,2,1,3,2,4,22,3,5,20,4,6,5,...",
          "output": "1.0850775241851807",
          "predict_none": "[1.148422]",
          "predict_rwse": "[0.523492]",
          "predict_lappe": "[0.494015]",
          "predict_srwe": "[0.82691]",
          "metadata_srwe_best_method": "tikhonov",
          "metadata_srwe_best_w1": "0.103667",
          "metadata_srwe_best_cosine": "0.7077",
          "metadata_sri_k20": 0.35176,
          "metadata_dataset": "ZINC-subset"
        }
      ]
    }
  ]
}